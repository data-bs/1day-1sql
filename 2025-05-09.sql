
-- ๐ก SQL ๋ฌธ์: ์์๋ณ ๋์ ๋ก๊ทธ์ธ ์ผ ์ ๊ณ์ฐ

-- ๐ ๋ฌธ์ ์ค๋ช
-- user_logins ํ์ด๋ธ์๋ ์ฌ์ฉ์๋ณ ๋ก๊ทธ์ธ ๋์ง ๊ธฐ๋ก์ด ์์ต๋๋ค.
-- ๊ฐ ์์์ ๋ํด ๋ก๊ทธ์ธ ๋์ง๋ฅผ ๊ธฐ์ค์ผ๋ก ์๋ฌํ์ ๋,
-- ๋งค์ผ ํ์ฌ๊น์ง ๋ช ๋ฒ์ด๋ ๋ก๊ทธ์ธํ๋์ง๋ฅผ ๋ํ๋ด๋ ๋์ ๋ก๊ทธ์ธ ์ผ์๋ฅผ ๊ตฌํ์ธ์.

-- ๊ฒฐ๊ณผ ์ปฌ๋ผ:
-- user_id         : ์ฌ์ฉ์ ๊ณ์ ID
-- login_date      : ๋ก๊ทธ์ธ ๋์ง
-- cumulative_days : ํด๋น ๋์ง๊น์ง ๋์ ๋ก๊ทธ์ธ ์ผ ์

-- ๐๏ธ ํ์ด๋ธ ์์ฑ
CREATE TABLE user_logins (
    user_id INT,
    login_date DATE
);

-- โ ์์ ๋ฐ์ดํฐ ์ฝ์
INSERT INTO user_logins (user_id, login_date) VALUES
-- user 1: 5๋ฒ ๋ก๊ทธ์ธ
(1, '2024-01-01'),
(1, '2024-01-02'),
(1, '2024-01-05'),
(1, '2024-01-10'),
(1, '2024-01-12'),

-- user 2: 4๋ฒ ๋ก๊ทธ์ธ
(2, '2024-02-01'),
(2, '2024-02-03'),
(2, '2024-02-04'),
(2, '2024-02-10'),

-- user 3: 3๋ฒ ๋ก๊ทธ์ธ
(3, '2024-03-01'),
(3, '2024-03-05'),
(3, '2024-03-07');

-- โ ์๋ต ์ฟผ๋ฆฌ (PostgreSQL ๊ธฐ์ค)
-- ๊ฐ ๋ก๊ทธ์ธ ๋์ง๊น์ง์ ๋์ ๋ก๊ทธ์ธ ํ์๋ฅผ ์ถ๋ฅ
-- PARTITION BY user_id + ORDER BY login_date ์กฐํฉ์ผ๋ก ํด๊ฒฐ ๊ฐ๋ฅ

SELECT
    user_id,
    login_date,
    ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY login_date) AS cumulative_days
FROM user_logins
ORDER BY user_id, login_date;
