-- ====================================
-- ðŸ“Œ ë¬¸ì œ ì„¤ëª…
-- ====================================
-- ë¬¸ì œ: ë¶€ì„œë³„ í‰ê·  ê¸‰ì—¬ êµ¬í•˜ê¸°
-- í…Œì´ë¸”: employees

-- ====================================
-- ðŸ“¦ ì˜ˆì‹œ ë°ì´í„° ìƒì„±
-- ====================================

CREATE TABLE employees (
    id INTEGER,
    name VARCHAR(100),
    department VARCHAR(100),
    salary INTEGER,
    join_date DATE
);

INSERT INTO employees (id, name, department, salary, join_date) VALUES
(1, 'Alice', 'HR', 4000, '2022-03-01'),
(2, 'Bob', 'IT', 6000, '2021-07-15'),
(3, 'Charlie', 'IT', 6600, '2020-09-10'),
(4, 'David', 'Sales', 5000, '2023-01-20'),
(5, 'Eve', 'Sales', 5400, '2023-03-15'),
(6, 'Frank', 'HR', 4200, '2020-05-25');

-- ====================================
-- ðŸ“ ë¬¸ì œ ì¡°ê±´
-- ====================================
-- ì¡°ê±´: ìµœê·¼ 2ë…„ ì´ë‚´ ìž…ì‚¬í•œ ì§ì›ë“¤ë§Œ ëŒ€ìƒìœ¼ë¡œ ë¶€ì„œë³„ í‰ê·  ê¸‰ì—¬ë¥¼ ê³„ì‚°í•˜ì‹œì˜¤.
-- í‰ê·  ê¸‰ì—¬ëŠ” ì†Œìˆ˜ì  1ìžë¦¬ê¹Œì§€ ë°˜ì˜¬ë¦¼í•˜ë©° ë¶€ì„œëª… ê¸°ì¤€ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•©ë‹ˆë‹¤.

-- ====================================
-- âœ… ì •ë‹µ SQL ì¿¼ë¦¬
-- ====================================

SELECT
    department,
    ROUND(AVG(salary), 1) AS avg_salary
FROM
    employees
WHERE
    join_date >= DATE('now', '-2 years')
GROUP BY
    department
ORDER BY
    department;